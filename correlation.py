#!/usr/bin/env python3

import numpy
import operator
import json

# Amino acid patterns: A   C   D   E   F   G   H   I   K   L   M   N   P   Q   R   S   T   V   W   X   Y

mammals = {
    "ailuropoda_melanoleuca": [1452967, 484494, 824110, 1251596, 646892, 1462850, 536671, 720501, 988191, 1896108, 390854, 607705, 1370815, 924544, 1283714, 1696490, 1081713, 1179558, 283121, 4923, 413899],
    "bos_taurus": [1446765, 472110, 831600, 1265074, 643521, 1440962, 523863, 723326, 990748, 1900894, 389589, 597870, 1348608, 927135, 1220572, 1658309, 1057106, 1156767, 276947, 1335, 418014],
    "callithrix_jacchus": [1454406, 472697, 830444, 1292551, 632067, 1416351, 532797, 746547, 1045397, 1859393, 399949, 631282, 1296176, 935907, 1206744, 1647282, 1061444, 1139830, 271724, 3600, 426304],
    "canis_familiaris": [1516219, 467707, 824137, 1295738, 611862, 1543447, 522448, 712210, 1014873, 1862356, 384782, 588725, 1451244, 911974, 1318830, 1629575, 1043589, 1146364, 278142, 1254, 405403],
    "cavia_porcellus": [1513025, 532439, 856924, 1279859, 666670, 1444814, 576988, 761010, 1020759, 2028031, 426897, 630122, 1346135, 1020110, 1218354, 1775600, 1137779, 1226661, 304497, 1713, 439259],
    "chlorocebus_sabaeus": [1934769, 642036, 1180889, 1897722, 908945, 1944133, 768080, 1227451, 1673755, 2648998, 605801, 999125, 1796219, 1367387, 1670104, 2306833, 1614364, 1561509, 418548, 2516, 608631],
    "choloepus_hoffmanni": [958494, 325501, 607494, 938116, 469722, 956257, 377934, 576972, 800104, 1332712, 310022, 492405, 886729, 672925, 806189, 1173175, 773747, 800063, 199353, 38946, 305235],
    "dasypus_novemcinctus": [1835784, 541397, 899539, 1392090, 694065, 1800982, 593088, 774027, 1068986, 2156976, 421875, 646337, 1706287, 1040879, 1513603, 1872133, 1176352, 1291649, 329705, 6625, 438317],
    "dipodomys_ordii": [3327859, 614791, 1989888, 4309866, 544080, 4498256, 1621150, 800196, 3201377, 1937223, 437591, 845766, 1490111, 3145476, 2845916, 2853568, 3490224, 1573746, 418357, 41327, 501944],
    "echinops_telfairi": [1702232, 613950, 1026677, 1484652, 779469, 1713541, 701266, 929269, 1262117, 2278961, 541801, 785727, 1572375, 1151539, 1535735, 2077851, 1389320, 1437891, 367994, 48763, 489875],
    "equus_caballus": [2566279, 947110, 1482351, 2423994, 1110009, 2531774, 1147848, 1692375, 2130415, 3449822, 776390, 1450070, 2580973, 1734396, 2404850, 2937670, 2348787, 1881520, 562260, 4325, 752924],
    "erinaceus_europaeus": [1496118, 503053, 948531, 1388107, 661177, 1420537, 648101, 893982, 1142898, 1988334, 421862, 687803, 1409203, 982751, 1308730, 1829690, 1191529, 1188628, 387894, 55085, 481473],
    "felis_catus": [1425730, 468761, 823085, 1248005, 640454, 1477060, 528656, 712286, 987677, 1851514, 373584, 604210, 1379456, 898267, 1297050, 1640127, 1079977, 1168178, 278707, 1879, 407513],
    "gorilla_gorilla": [1342952, 429433, 791442, 1560982, 598821, 1633562, 490286, 747114, 984009, 1747076, 644144, 921421, 1233402, 890604, 1197859, 1584070, 1028761, 1085672, 521751, 2873, 394002],
    "homo_sapiens": [1545658, 493412, 897487, 1431864, 667829, 1560987, 581661, 823659, 1099940, 1980924, 448229, 687865, 1424945, 994349, 1286984, 1764002, 1149501, 1216595, 307177, 1297, 454366],
    "ictidomys_tridecemlineatus": [1292323, 436113, 773919, 1161490, 593834, 1316234, 488247, 688337, 915045, 1784156, 371115, 571524, 1229534, 879766, 1075024, 1541204, 979159, 1072586, 265778, 2088, 386636],
    "loxodonta_africana": [1406798, 476700, 857567, 1315197, 672223, 1460631, 551665, 799417, 1057386, 1999171, 433724, 690437, 1403775, 984157, 1277506, 1728080, 1181148, 1187809, 290720, 3368, 448137],
    "macaca_mulatta": [1412824, 474451, 833798, 1270944, 644266, 1381835, 539359, 755587, 1038099, 1881658, 409047, 637291, 1290126, 935722, 1171106, 1637697, 1068467, 1148120, 272175, 43330, 435931],
    "macropus_eugenii": [1197430, 378174, 845382, 1451874, 625779, 1236424, 463947, 842174, 1250550, 1714087, 432465, 722401, 1088138, 937363, 1044758, 1552103, 1003571, 1059108, 243766, 39904, 419001],
    "microcebus_murinus": [1383219, 443795, 728466, 1110553, 536216, 1355608, 481731, 607549, 850256, 1665467, 330713, 511085, 1294103, 842961, 1203352, 1478583, 962909, 1023483, 263238, 17765, 344563],
    "monodelphis_domestica": [1743110, 558819, 1229216, 1955899, 946769, 1773891, 723413, 1289572, 1859697, 2610056, 597197, 1147111, 1661752, 1411523, 1637510, 2283769, 1608997, 1419571, 378918, 19979, 619207],
    "mus_musculus": [1372692, 475479, 899403, 1769272, 677789, 1414440, 543097, 822727, 1291644, 1937527, 446461, 678709, 1214250, 974682, 1229915, 1726266, 1122614, 1212383, 259453, 1137, 483455],
    "mustela_putorius_furo": [1531119, 495589, 851792, 1299418, 659111, 1573096, 551537, 726952, 1007438, 1951156, 395865, 614498, 1478075, 946338, 1379013, 1751292, 1117784, 1203003, 294961, 1742, 412979],
    "myotis_lucifugus": [1806444, 576763, 923150, 1389607, 648356, 1773923, 624338, 775891, 1031636, 2145029, 452304, 650232, 1707458, 1110542, 1467588, 1915083, 1186317, 1279983, 357169, 4793, 424636],
    "nomascus_leucogenys": [1259935, 398754, 758123, 1177178, 559500, 1248431, 471416, 666464, 930564, 1649435, 366958, 566549, 1142848, 817755, 1041419, 1445554, 914816, 998634, 242376, 3042, 374786],
    "ochotona_princeps": [2623227, 935815, 1340684, 2171019, 1032036, 2465725, 971649, 1236096, 1625398, 3437035, 730101, 1063804, 2242427, 1673141, 2058499, 2864677, 1867136, 2086839, 535128, 30467, 731264],
    "ornithorhynchus_anatinus": [1729677, 586972, 1121800, 1578498, 870449, 1878441, 674377, 1092360, 1260595, 2547018, 479218, 814375, 1806078, 1059667, 1832948, 2256295, 1434322, 1498123, 354984, 37814, 571030],
    "oryctolagus_cuniculus": [1808772, 598350, 897190, 1345256, 681500, 1731326, 633581, 740139, 1019847, 2154588, 418201, 634535, 1637872, 1083541, 1498048, 1928663, 1240998, 1336644, 340788, 3065, 424642],
    "otolemur_garnettii": [1266163, 435951, 769264, 1163878, 601688, 1255118, 485169, 701356, 962961, 1735197, 370712, 584296, 1147501, 858495, 1053571, 1509644, 979489, 1064734, 248122, 1602, 408791],
    "ovis_aries": [1278502, 414744, 762857, 1154319, 578229, 1277403, 465113, 668185, 909855, 1712412, 352038, 548941, 1188373, 846791, 1086844, 1493147, 961918, 1047587, 251210, 2092, 375275],
    "pan_troglodytes": [1370118, 440640, 802393, 1442470, 598212, 1516451, 499163, 756392, 1010123, 1780423, 555772, 817943, 1258898, 908463, 1162067, 1573036, 1006884, 1082120, 421905, 4264, 404203],
    "papio_anubis": [1374208, 445211, 808076, 1274097, 608149, 1375623, 510011, 717566, 1002541, 1780783, 387582, 600550, 1256068, 887052, 1158060, 1564253, 1014643, 1096223, 259255, 3211, 407448],
    "pongo_abelii": [1318470, 436915, 770439, 1182477, 592901, 1290982, 492866, 697553, 946405, 1734729, 377248, 584267, 1184945, 862723, 1078065, 1500981, 963833, 1048802, 253619, 6428, 399411],
    "procavia_capensis": [1365181, 464832, 828774, 1229225, 601719, 1323031, 526482, 735243, 1046873, 1848604, 409898, 629467, 1221318, 944441, 1186137, 1640513, 1152222, 1168188, 279266, 33651, 418552],
    "pteropus_vampyrus": [1514950, 472141, 821655, 1218079, 620560, 1454707, 522207, 682620, 938683, 1818471, 374916, 575591, 1382239, 879593, 1361384, 1677064, 1072855, 1146514, 278342, 13514, 385528],
    "rattus_norvegicus": [1376121, 482334, 908833, 1525704, 689235, 1356892, 549807, 829990, 1166311, 1946911, 449373, 690446, 1200480, 961907, 1192816, 1718840, 1142891, 1254399, 262044, 2810, 490282],
    "sarcophilus_harrisii": [969231, 309428, 687680, 1165948, 517112, 1039311, 357095, 684476, 943656, 1424799, 322884, 554921, 927676, 705885, 877301, 1259115, 798408, 844650, 193515, 5822, 364009],
    "sorex_araneus": [1571056, 509272, 962756, 1367615, 686771, 1521734, 615145, 882198, 1123084, 2030092, 496562, 741745, 1411272, 1018260, 1486206, 1817136, 1197126, 1203530, 336063, 40210, 474176],
    "sus_scrofa": [1516942, 491426, 846161, 1300174, 669809, 1535786, 545895, 739865, 1032338, 1971539, 398744, 617025, 1441166, 958263, 1302633, 1725587, 1084920, 1175903, 294400, 2792, 419242],
    "tarsius_syrichta": [1127543, 411089, 726127, 1088714, 570343, 1142745, 480182, 697072, 951165, 1599189, 369531, 577944, 1058054, 816520, 965786, 1433339, 941172, 981097, 244486, 44484, 382927],
    "tupaia_belangeri": [1461369, 502531, 855806, 1298758, 654771, 1482282, 642267, 780505, 1091654, 1914259, 451683, 612403, 1381616, 914743, 1305231, 1752533, 1189220, 1197464, 310032, 21972, 423959],
    "tursiops_truncatus": [1391746, 444555, 765747, 1170217, 580146, 1391105, 491654, 649923, 916644, 1761124, 348536, 555916, 1310197, 867041, 1211759, 1572903, 1004986, 1089618, 264870, 9434, 376635],
}

actinopterygii = {
    "astyanax_mexicanus": [1130681, 389220, 800374, 1143149, 557532, 1028108, 446624, 691089, 913049, 1528956, 359607, 617838, 944551, 789981, 1020408, 1473390, 961342, 1032796, 186120, 3286, 413228],
    "danio_rerio": [1124979, 444338, 923231, 1211745, 657184, 1033482, 509121, 840754, 1054459, 1661107, 416035, 733483, 933554, 854775, 1039662, 1605976, 1080390, 1131073, 195296, 1052, 467816],
    "gadus_morhua": [1247939, 401907, 900379, 1160667, 597117, 1184439, 485479, 714042, 888882, 1649911, 407780, 642413, 1042501, 786015, 1145817, 1444383, 1030010, 1163747, 210287, 20752, 457673],
    "gasterosteus_aculeatus": [1343156, 452743, 946943, 1239573, 661033, 1224744, 522576, 751183, 982553, 1749439, 405474, 686469, 1089027, 852143, 1261412, 1621378, 1099850, 1237040, 217776, 6784, 461283],
    "lepisosteus_oculatus": [1036097, 368941, 689374, 987233, 520970, 955923, 381349, 614974, 805825, 1390396, 301723, 530647, 852301, 703577, 919171, 1271744, 827998, 928809, 177558, 973, 369494],
    "oreochromis_niloticus": [1522624, 570207, 1132604, 1517872, 793068, 1378188, 645886, 995663, 1331881, 2126872, 507182, 884969, 1244463, 1099950, 1377297, 2018025, 1400904, 1487791, 277904, 2108, 582206],
    "oryzias_latipes": [1657807, 608303, 1203994, 1587237, 923000, 1467845, 716333, 1057296, 1428200, 2345906, 544575, 951986, 1392886, 1201509, 1625722, 2186493, 1474388, 1594724, 318420, 40473, 571803],
    "poecilia_formosa": [1398635, 505880, 1019283, 1385530, 754195, 1282604, 560577, 858969, 1170333, 1943611, 450783, 797373, 1158404, 1005789, 1315331, 1861908, 1202484, 1312493, 244120, 1721, 487114],
    "takifugu_rubripes": [1020987, 352365, 762542, 977685, 537439, 929966, 404945, 637022, 799676, 1421979, 336403, 567634, 827691, 703909, 919100, 1291913, 854618, 973463, 176381, 2673, 375592],
    "tetraodon_nigroviridis": [1781124, 566908, 1202339, 1592906, 840689, 1611179, 638377, 928429, 1236238, 2321803, 520812, 839435, 1432173, 1154246, 1564788, 2084528, 1317450, 1553659, 301357, 3616, 584512],
    "xiphophorus_maculatus": [2155629, 746660, 1576270, 2138115, 1136190, 1973719, 844391, 1316313, 1771105, 2988075, 698899, 1206432, 1791005, 1534692, 1978768, 2835800, 1804917, 2002293, 363060, 7079, 757783]
}

aves = {
    "anas_platyrhynchos": [1201516, 445335, 640294, 984945, 534922, 1040648, 441202, 621460, 875405, 1529371, 324678, 537211, 952683, 800272, 892430, 1364966, 863139, 929927, 217714, 6049, 352651],
    "ficedula_albicollis": [1240834, 444519, 713932, 1093798, 525345, 1211829, 443192, 661129, 910997, 1542753, 330425, 538690, 1126046, 822556, 945310, 1408436, 864669, 946869, 231015, 2179, 344214],
    "gallus_gallus": [1384655, 487720, 698265, 1096854, 565564, 1157029, 480753, 670734, 918337, 1653873, 356293, 573288, 1075775, 854746, 1052914, 1497749, 935177, 1015528, 228021, 3410, 386634],
    "meleagris_gallopavo": [1004018, 374977, 569726, 879350, 462995, 840863, 377760, 566077, 763994, 1307291, 290988, 481773, 763261, 681139, 742904, 1178380, 737825, 800884, 177544, 2197, 320248],
    "taeniopygia_guttata": [1539297, 552218, 791659, 1280732, 642312, 1383956, 546979, 753709, 1071038, 1875418, 392740, 628185, 1304660, 989377, 1183932, 1700522, 1056585, 1102637, 283878, 10939, 401219]
}

test = {
    "anolis_carolinensis": [
            "Reptilia",
            [3138876, 932412, 2245045, 3114614, 1623291, 2746089, 1249335, 2207085, 3016677, 4417004, 854042, 1656135, 2676519, 2299212, 2913665, 3324721, 2494659, 2573663, 785716, 3818, 1006857]
        ],
    "ciona_intestinalis": [
            "Ascidiacea",
            [388343, 138437, 365942, 422864, 240617, 356354, 157836, 345345, 418582, 537940, 151385, 342651, 315405, 272661, 351737, 544888, 419163, 434638, 66242, 613, 198298]
        ],
    "ciona_savignyi": [
            "Ascidiacea",
            [1861147, 725678, 1692542, 1887351, 1227190, 1764629, 802013, 1726499, 1918951, 2669204, 744727, 1621427, 1572626, 1299146, 1662859, 2672947, 2005132, 2054975, 356051, 97443, 961663]
        ],
    "drosophila_melanogaster": [
            "Insecta",
            [1328955, 352607, 906160, 1120128, 624096, 1102400, 470818, 867579, 995165, 1607773, 406379, 807451, 1004154, 882012, 1093318, 1486235, 1041949, 1085900, 196119, 700, 525764]
        ],
    "latimeria_chalumnae": [
            "Sarcopterygii",
            [2447835, 850746, 1574399, 2208645, 1139273, 2442916, 1001309, 1521576, 1988253, 3338796, 760803, 1298984, 2186057, 1670893, 2134166, 3002695, 1988775, 2122712, 546557, 6120, 789128]
        ],
    "pelodiscus_sinensis": [
            "Sauropsida",
            [1507824, 503736, 819291, 1219322, 604529, 1389042, 538457, 772770, 987746, 1835396, 405514, 644677, 1334285, 946718, 1165655, 1665283, 1090405, 1125642, 280950, 3279, 441884]
        ],
    "petromyzon_marinus": [
            "Hyperoartia",
            [900305, 269603, 494880, 594738, 324338, 739331, 327261, 398469, 432853, 902398, 212174, 364232, 628832, 428997, 813778, 849942, 634738, 718751, 124523, 6659, 232356]
        ],
    "xenopus_tropicalis": [
            "Amphibia",
            [1348254, 446793, 934679, 1255000, 682757, 1204373, 526864, 986614, 1149101, 1824175, 423365, 801094, 1123964, 923222, 1096081, 1609924, 1166552, 1177976, 248112, 4926, 579360]
        ],
    "vicugna_pacos": [
        "Mammalia",
        [1080420, 408138, 659163, 1022625, 550865, 1143696, 489990, 633751, 830378, 1570458, 312033, 525755, 1054785, 756233, 1050438, 1418957, 920196, 943093, 221572, 29226, 327143]
    ],
    "macaca_mulatta": [
        "Mammalia",
        [1412824, 474451, 833798, 1270944, 644266, 1381835, 539359, 755587, 1038099, 1881658, 409047, 637291, 1290126, 935722, 1171106, 1637697, 1068467, 1148120, 272175, 43330, 435931]
    ],

}

class Score():
    def mammalian(seq):
        scores = []
        for organism, sequence in mammals.items():
            scores.append(numpy.corrcoef(sequence, seq)[0][1])
        return sum(scores) / len(scores)

    def actinopterygii(seq):
        scores = []
        for organism, sequence in actinopterygii.items():
            scores.append(numpy.corrcoef(sequence, seq)[0][1])
        return sum(scores) / len(scores)

    def aves(seq):
        scores = []
        for organism, sequence in aves.items():
            scores.append(numpy.corrcoef(sequence, seq)[0][1])
        return sum(scores) / len(scores)

    def closest_to(seq):
        scores = {
            'mammalian':        Score.mammalian(seq),
            'aves':             Score.aves(seq),
            'actinopterygii':   Score.actinopterygii(seq)
        }
        key_max = max(scores.items(), key=operator.itemgetter(1))[0]
        scores['closest_to'] = key_max
        print(scores)
        return scores['closest_to']

for org in test:
    _str = "{0}\t is closest to {1} with respect to amino acids pattern."
    org_close = Score.closest_to(test[org][1])

    print(_str.format(org, org_close))